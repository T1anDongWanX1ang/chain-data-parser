2025-09-12 18:43:32 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_setup_logging:992 - 实例 d70bfc5c 日志配置完成 - 控制台输出 + 文件输出: /Users/a1-6/Desktop/PycharmProjects/chain-parser/chain-data-parser/logs/pipeline_1757560167_20250912_184330.log
2025-09-12 18:43:32 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:__init__:877 - 从配置字典加载管道配置 - aavev3
2025-09-12 18:43:32 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_validate_config:921 - 配置验证通过: 4 个组件
2025-09-12 18:43:32 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:__init__:886 - 优化版区块链数据管道初始化完成 - aavev3
2025-09-12 18:43:32 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:__init__:888 - 日志输出路径: logs/pipeline_1757560167_20250912_184330.log
2025-09-12 18:43:32 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:execute_pipeline:1095 - 开始执行优化版管道: aavev3
2025-09-12 18:43:32 | INFO     | [global] | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-09-12 18:43:35 | INFO     | [global] | app.component.pipeline_executor_optimized:_async_load_abi_from_database:206 - 从数据库加载ABI成功: AaveV3 (ID: 18)
2025-09-12 18:43:37 | INFO     | [global] | app.services.evm_parser:get_web3:29 - 成功连接到 ethereum 网络
2025-09-12 18:43:37 | INFO     | [global] | app.component.event_monitor:__init__:46 - 事件监控器已初始化 - 链: ethereum, 合约: 0x87870bca3f3fd6335c3f4ce8392d69350b4fa4e2
2025-09-12 18:43:37 | INFO     | [global] | app.component.pipeline_executor_optimized:initialize:131 - 事件监控器初始化成功: 0x87870bca3f3fd6335c3f4ce8392d69350b4fa4e2
2025-09-12 18:43:37 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_initialize_components:1032 - 组件初始化成功: step1 (event_monitor)
2025-09-12 18:43:37 | INFO     | [global] | app.component.pipeline_executor_optimized:initialize:249 - 合约调用器配置已注册（动态地址）: Borrow -> {args.reserve}
2025-09-12 18:43:37 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_initialize_components:1032 - 组件初始化成功: step2 (contract_caller)
2025-09-12 18:43:37 | INFO     | [global] | app.component.dict_mapper:__init__:29 - 字典映射器初始化完成 - 规则数量: 15
2025-09-12 18:43:37 | INFO     | [global] | app.component.dict_mapper:__init__:29 - 字典映射器初始化完成 - 规则数量: 13
2025-09-12 18:43:37 | INFO     | [global] | app.component.dict_mapper:__init__:29 - 字典映射器初始化完成 - 规则数量: 12
2025-09-12 18:43:37 | INFO     | [global] | app.component.dict_mapper:__init__:29 - 字典映射器初始化完成 - 规则数量: 13
2025-09-12 18:43:37 | INFO     | [global] | app.component.pipeline_executor_optimized:initialize:691 - 字典映射器初始化成功: 创建了 4 个映射器
2025-09-12 18:43:37 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_initialize_components:1032 - 组件初始化成功: step3 (dict_mapper)
2025-09-12 18:43:37 | INFO     | [global] | app.component.kafka_client:__init__:32 - Kafka客户端初始化 - 服务器: ['localhost:9092']
2025-09-12 18:43:37 | INFO     | [global] | app.component.kafka_client:init_producer:76 - Kafka生产者初始化成功
2025-09-12 18:43:37 | INFO     | [global] | app.component.pipeline_executor_optimized:initialize:777 - Kafka生产者初始化成功: localhost:9092
2025-09-12 18:43:37 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_initialize_components:1032 - 组件初始化成功: step4 (kafka_producer)
2025-09-12 18:43:37 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:141 - 启动事件监控...
2025-09-12 18:43:37 | INFO     | [global] | app.component.event_monitor:start_monitoring:195 - 开始监控合约事件 - 0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2
2025-09-12 18:43:37 | INFO     | [global] | app.component.event_monitor:start_monitoring:206 - 从区块 23346460 开始监控
2025-09-12 18:43:37 | INFO     | [global] | app.component.event_monitor:_realtime_monitoring:219 - 启动实时监控模式
2025-09-12 18:43:41 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1062 - 开始处理管道数据: 9 个字段
2025-09-12 18:43:41 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1067 - 初始输入数据:
2025-09-12 18:43:41 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1068 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xb695e9c1e558e949a3633b7a16780441c5e2e2b1c5601eade3f984a162f5f0df",
  "block_number": 23346461,
  "log_index": 183,
  "timestamp": 1757673821,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
    "onBehalfOf": "0xE9376E04870e86A9a7B20e02A375d8a0668614AE",
    "referralCode": 0,
    "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
    "amount": 33300000000000000,
    "interestRateMode": 2,
    "borrowRate": "24842301209787273492093068"
  }
}
2025-09-12 18:43:41 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:332 - 开始处理数据库配置的合约调用器，共 1 个，当前事件名称: Borrow
2025-09-12 18:43:41 | INFO     | [global] | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-09-12 18:43:43 | INFO     | [global] | app.component.pipeline_executor_optimized:_async_load_abi_from_database:575 - 从数据库加载ABI成功: ERC20 (ID: 17)
2025-09-12 18:43:43 | ERROR    | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:405 - 合约调用失败: decimals, 错误: when sending a str, it must be a hex string. Got: '{args.reserve}'
2025-09-12 18:43:43 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:417 - 合约调用器处理完成，结果keys: ['decimals']
2025-09-12 18:43:43 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step2 执行完成
2025-09-12 18:43:43 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step2 执行后的数据:
2025-09-12 18:43:43 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xb695e9c1e558e949a3633b7a16780441c5e2e2b1c5601eade3f984a162f5f0df",
  "block_number": 23346461,
  "log_index": 183,
  "timestamp": 1757673821,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
    "onBehalfOf": "0xE9376E04870e86A9a7B20e02A375d8a0668614AE",
    "referralCode": 0,
    "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
    "amount": 33300000000000000,
    "interestRateMode": 2,
    "borrowRate": "24842301209787273492093068"
  },
  "decimals": null,
  "step_1_step2": {
    "decimals": null
  }
}
2025-09-12 18:43:43 | WARNING  | [global] | app.component.dict_mapper:_apply_mapping_rule:130 - 转换器 decimal_normalize_with_field 未找到
2025-09-12 18:43:43 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:727 - 应用映射器成功: event_name=Borrow, 规则数=15, 映射字段数=15
2025-09-12 18:43:43 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step3 执行完成
2025-09-12 18:43:43 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step3 执行后的数据:
2025-09-12 18:43:43 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xb695e9c1e558e949a3633b7a16780441c5e2e2b1c5601eade3f984a162f5f0df",
  "block_number": 23346461,
  "log_index": 183,
  "timestamp": 1757673821,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
  "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
  "onBehalfOf": "0xE9376E04870e86A9a7B20e02A375d8a0668614AE",
  "amount": 33300000000000000,
  "interestRateMode": 2,
  "borrowRate": "24842301209787273492093068",
  "referralCode": 0
}
2025-09-12 18:43:43 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:794 - 准备发送到Kafka - topic: test1
2025-09-12 18:43:43 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:795 - 发送数据: {
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xb695e9c1e558e949a3633b7a16780441c5e2e2b1c5601eade3f984a162f5f0df",
  "block_number": 23346461,
  "log_index": 183,
  "timestamp": 1757673821,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
  "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
  "onBehalfOf": "0xE9376E04870e86A9a7B20e02A375d8a0668614AE",
  "amount": 33300000000000000,
  "interestRateMode": 2,
  "borrowRate": "24842301209787273492093068",
  "referralCode": 0
}
2025-09-12 18:43:44 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:801 - ✅ Kafka消息发送成功: topic=test1
2025-09-12 18:43:44 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step4 执行完成
2025-09-12 18:43:44 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step4 执行后的数据:
2025-09-12 18:43:44 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xb695e9c1e558e949a3633b7a16780441c5e2e2b1c5601eade3f984a162f5f0df",
  "block_number": 23346461,
  "log_index": 183,
  "timestamp": 1757673821,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
  "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
  "onBehalfOf": "0xE9376E04870e86A9a7B20e02A375d8a0668614AE",
  "amount": 33300000000000000,
  "interestRateMode": 2,
  "borrowRate": "24842301209787273492093068",
  "referralCode": 0
}
2025-09-12 18:43:44 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1085 - 管道数据处理完成: 执行了 2 个步骤
2025-09-12 18:43:45 | INFO     | [global] | app.component.event_monitor:_realtime_monitoring:232 - 区块 23346461 处理了 1 个事件
2025-09-12 18:43:45 | INFO     | [global] | app.services.pipeline_config_service:get_task_log:663 - 读取任务日志成功: task_id=67, log_path=/Users/a1-6/Desktop/PycharmProjects/chain-parser/chain-data-parser/logs/pipeline_1757560167_20250912_184330.log, returned_lines=100
2025-09-12 18:43:49 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1062 - 开始处理管道数据: 9 个字段
2025-09-12 18:43:49 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1067 - 初始输入数据:
2025-09-12 18:43:49 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1068 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xa2f1f064c64e74c6cf4ca3f822a9796a593752c27af56a0c31902c4554a557a1",
  "block_number": 23346462,
  "log_index": 156,
  "timestamp": 1757673829,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
    "onBehalfOf": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
    "referralCode": 0,
    "user": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
    "amount": "1200000000000000000000",
    "interestRateMode": 2,
    "borrowRate": "5586805197690505159910456"
  }
}
2025-09-12 18:43:49 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:332 - 开始处理数据库配置的合约调用器，共 1 个，当前事件名称: Borrow
2025-09-12 18:43:49 | INFO     | [global] | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-09-12 18:43:51 | INFO     | [global] | app.component.pipeline_executor_optimized:_async_load_abi_from_database:575 - 从数据库加载ABI成功: ERC20 (ID: 17)
2025-09-12 18:43:52 | ERROR    | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:405 - 合约调用失败: decimals, 错误: when sending a str, it must be a hex string. Got: '{args.reserve}'
2025-09-12 18:43:52 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:417 - 合约调用器处理完成，结果keys: ['decimals']
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step2 执行完成
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step2 执行后的数据:
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xa2f1f064c64e74c6cf4ca3f822a9796a593752c27af56a0c31902c4554a557a1",
  "block_number": 23346462,
  "log_index": 156,
  "timestamp": 1757673829,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
    "onBehalfOf": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
    "referralCode": 0,
    "user": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
    "amount": "1200000000000000000000",
    "interestRateMode": 2,
    "borrowRate": "5586805197690505159910456"
  },
  "decimals": null,
  "step_1_step2": {
    "decimals": null
  }
}
2025-09-12 18:43:52 | WARNING  | [global] | app.component.dict_mapper:_apply_mapping_rule:130 - 转换器 decimal_normalize_with_field 未找到
2025-09-12 18:43:52 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:727 - 应用映射器成功: event_name=Borrow, 规则数=15, 映射字段数=15
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step3 执行完成
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step3 执行后的数据:
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xa2f1f064c64e74c6cf4ca3f822a9796a593752c27af56a0c31902c4554a557a1",
  "block_number": 23346462,
  "log_index": 156,
  "timestamp": 1757673829,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
  "user": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
  "onBehalfOf": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
  "amount": "1200000000000000000000",
  "interestRateMode": 2,
  "borrowRate": "5586805197690505159910456",
  "referralCode": 0
}
2025-09-12 18:43:52 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:794 - 准备发送到Kafka - topic: test1
2025-09-12 18:43:52 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:795 - 发送数据: {
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xa2f1f064c64e74c6cf4ca3f822a9796a593752c27af56a0c31902c4554a557a1",
  "block_number": 23346462,
  "log_index": 156,
  "timestamp": 1757673829,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
  "user": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
  "onBehalfOf": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
  "amount": "1200000000000000000000",
  "interestRateMode": 2,
  "borrowRate": "5586805197690505159910456",
  "referralCode": 0
}
2025-09-12 18:43:52 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:801 - ✅ Kafka消息发送成功: topic=test1
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step4 执行完成
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step4 执行后的数据:
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0xa2f1f064c64e74c6cf4ca3f822a9796a593752c27af56a0c31902c4554a557a1",
  "block_number": 23346462,
  "log_index": 156,
  "timestamp": 1757673829,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
  "user": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
  "onBehalfOf": "0xfd83F8bCEE04B49199BA72c65cd34cE3Ca938F96",
  "amount": "1200000000000000000000",
  "interestRateMode": 2,
  "borrowRate": "5586805197690505159910456",
  "referralCode": 0
}
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1085 - 管道数据处理完成: 执行了 2 个步骤
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1062 - 开始处理管道数据: 9 个字段
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1067 - 初始输入数据:
2025-09-12 18:43:52 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1068 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x3dc8041cb72b45e4f42e7ff81e2d130835b3ddd9c6f8a1928b2f91b7e0904aa0",
  "block_number": 23346462,
  "log_index": 509,
  "timestamp": 1757673832,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
    "onBehalfOf": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
    "referralCode": 0,
    "user": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
    "amount": 1100000000,
    "interestRateMode": 2,
    "borrowRate": "60294962958060479913978507"
  }
}
2025-09-12 18:43:52 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:332 - 开始处理数据库配置的合约调用器，共 1 个，当前事件名称: Borrow
2025-09-12 18:43:52 | INFO     | [global] | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-09-12 18:43:54 | INFO     | [global] | app.component.pipeline_executor_optimized:_async_load_abi_from_database:575 - 从数据库加载ABI成功: ERC20 (ID: 17)
2025-09-12 18:43:54 | ERROR    | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:405 - 合约调用失败: decimals, 错误: when sending a str, it must be a hex string. Got: '{args.reserve}'
2025-09-12 18:43:54 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:417 - 合约调用器处理完成，结果keys: ['decimals']
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step2 执行完成
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step2 执行后的数据:
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x3dc8041cb72b45e4f42e7ff81e2d130835b3ddd9c6f8a1928b2f91b7e0904aa0",
  "block_number": 23346462,
  "log_index": 509,
  "timestamp": 1757673832,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
    "onBehalfOf": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
    "referralCode": 0,
    "user": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
    "amount": 1100000000,
    "interestRateMode": 2,
    "borrowRate": "60294962958060479913978507"
  },
  "decimals": null,
  "step_1_step2": {
    "decimals": null
  }
}
2025-09-12 18:43:54 | WARNING  | [global] | app.component.dict_mapper:_apply_mapping_rule:130 - 转换器 decimal_normalize_with_field 未找到
2025-09-12 18:43:54 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:727 - 应用映射器成功: event_name=Borrow, 规则数=15, 映射字段数=15
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step3 执行完成
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step3 执行后的数据:
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x3dc8041cb72b45e4f42e7ff81e2d130835b3ddd9c6f8a1928b2f91b7e0904aa0",
  "block_number": 23346462,
  "log_index": 509,
  "timestamp": 1757673832,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
  "user": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
  "onBehalfOf": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
  "amount": 1100000000,
  "interestRateMode": 2,
  "borrowRate": "60294962958060479913978507",
  "referralCode": 0
}
2025-09-12 18:43:54 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:794 - 准备发送到Kafka - topic: test1
2025-09-12 18:43:54 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:795 - 发送数据: {
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x3dc8041cb72b45e4f42e7ff81e2d130835b3ddd9c6f8a1928b2f91b7e0904aa0",
  "block_number": 23346462,
  "log_index": 509,
  "timestamp": 1757673832,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
  "user": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
  "onBehalfOf": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
  "amount": 1100000000,
  "interestRateMode": 2,
  "borrowRate": "60294962958060479913978507",
  "referralCode": 0
}
2025-09-12 18:43:54 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:801 - ✅ Kafka消息发送成功: topic=test1
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step4 执行完成
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step4 执行后的数据:
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Borrow",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x3dc8041cb72b45e4f42e7ff81e2d130835b3ddd9c6f8a1928b2f91b7e0904aa0",
  "block_number": 23346462,
  "log_index": 509,
  "timestamp": 1757673832,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
  "user": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
  "onBehalfOf": "0xE408AB08a8024C5081E94eDf5fCd8e77635B18d7",
  "amount": 1100000000,
  "interestRateMode": 2,
  "borrowRate": "60294962958060479913978507",
  "referralCode": 0
}
2025-09-12 18:43:54 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1085 - 管道数据处理完成: 执行了 2 个步骤
2025-09-12 18:43:55 | INFO     | [global] | app.component.event_monitor:_realtime_monitoring:232 - 区块 23346462 处理了 2 个事件
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1062 - 开始处理管道数据: 9 个字段
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1067 - 初始输入数据:
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1068 - 
{
  "event_name": "Supply",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x1ffe25a4b43a646483d19dc296ffd20f7388f885c5149530d5e8521f07b29721",
  "block_number": 23346465,
  "log_index": 300,
  "timestamp": 1757673867,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
    "onBehalfOf": "0x3347cA5B4134bF9DFc635eCFC227F45F7493CFA6",
    "referralCode": 0,
    "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
    "amount": 224000000000000000
  }
}
2025-09-12 18:44:27 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:332 - 开始处理数据库配置的合约调用器，共 1 个，当前事件名称: Supply
2025-09-12 18:44:27 | INFO     | [global] | app.component.pipeline_executor_optimized:_execute_database_contract_callers:338 - 跳过不匹配的合约调用器: 配置事件=Borrow, 当前事件=Supply
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step2 执行完成
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step2 执行后的数据:
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Supply",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x1ffe25a4b43a646483d19dc296ffd20f7388f885c5149530d5e8521f07b29721",
  "block_number": 23346465,
  "log_index": 300,
  "timestamp": 1757673867,
  "chain": "ethereum",
  "chain_id": 1,
  "args": {
    "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
    "onBehalfOf": "0x3347cA5B4134bF9DFc635eCFC227F45F7493CFA6",
    "referralCode": 0,
    "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
    "amount": 224000000000000000
  }
}
2025-09-12 18:44:27 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:727 - 应用映射器成功: event_name=Supply, 规则数=13, 映射字段数=13
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step3 执行完成
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step3 执行后的数据:
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Supply",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x1ffe25a4b43a646483d19dc296ffd20f7388f885c5149530d5e8521f07b29721",
  "block_number": 23346465,
  "log_index": 300,
  "timestamp": 1757673867,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
  "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
  "onBehalfOf": "0x3347cA5B4134bF9DFc635eCFC227F45F7493CFA6",
  "amount": 224000000000000000,
  "referralCode": 0
}
2025-09-12 18:44:27 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:794 - 准备发送到Kafka - topic: test1
2025-09-12 18:44:27 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:795 - 发送数据: {
  "event_name": "Supply",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x1ffe25a4b43a646483d19dc296ffd20f7388f885c5149530d5e8521f07b29721",
  "block_number": 23346465,
  "log_index": 300,
  "timestamp": 1757673867,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
  "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
  "onBehalfOf": "0x3347cA5B4134bF9DFc635eCFC227F45F7493CFA6",
  "amount": 224000000000000000,
  "referralCode": 0
}
2025-09-12 18:44:27 | INFO     | [global] | app.component.pipeline_executor_optimized:execute:801 - ✅ Kafka消息发送成功: topic=test1
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1074 - 组件 step4 执行完成
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1078 - 组件 step4 执行后的数据:
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1079 - 
{
  "event_name": "Supply",
  "contract_address": "0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2",
  "transaction_hash": "0x1ffe25a4b43a646483d19dc296ffd20f7388f885c5149530d5e8521f07b29721",
  "block_number": 23346465,
  "log_index": 300,
  "timestamp": 1757673867,
  "chain": "ethereum",
  "chain_id": 1,
  "reserve": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
  "user": "0xd01607c3C5eCABa394D8be377a08590149325722",
  "onBehalfOf": "0x3347cA5B4134bF9DFc635eCFC227F45F7493CFA6",
  "amount": 224000000000000000,
  "referralCode": 0
}
2025-09-12 18:44:27 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_process_pipeline_data:1085 - 管道数据处理完成: 执行了 1 个步骤
2025-09-12 18:44:27 | INFO     | [global] | app.component.event_monitor:_realtime_monitoring:232 - 区块 23346465 处理了 1 个事件
2025-09-12 18:44:42 | INFO     | [global] | app.startup:shutdown_event:24 - 应用关闭中...
2025-09-12 18:44:42 | INFO     | [global] | app.services.task_monitor_service:_monitor_loop:147 - 任务监控守护进程被取消
2025-09-12 18:44:42 | INFO     | [global] | app.services.task_monitor_service:stop_monitoring:166 - 任务监控守护进程已停止
2025-09-12 18:44:42 | INFO     | [global] | app.services.task_monitor_service:shutdown_task_monitoring:201 - 任务监控系统已关闭
2025-09-12 18:44:42 | INFO     | [global] | app.startup:shutdown_event:29 - 应用关闭完成
2025-09-12 18:44:42 | INFO     | [global] | app.services.database_service:close:106 - 数据库连接已关闭
2025-09-12 18:44:42 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_cleanup_components:1132 - 组件清理完成: step1
2025-09-12 18:44:42 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_cleanup_components:1132 - 组件清理完成: step2
2025-09-12 18:44:42 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_cleanup_components:1132 - 组件清理完成: step3
2025-09-12 18:44:42 | INFO     | [d70bfc5c] | app.component.pipeline_executor_optimized:_cleanup_components:1132 - 组件清理完成: step4
