2025-08-27 16:46:36 | INFO     | app.utils.logger:setup_logger:38 - 日志系统初始化完成
2025-08-27 16:46:36 | INFO     | app.services.database_service:init_db:74 - 数据库已初始化，跳过
2025-08-27 16:46:36 | INFO     | app.startup:startup_event:9 - 应用启动中...
2025-08-27 16:46:36 | INFO     | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-08-27 16:46:36 | ERROR    | app.services.task_monitor_service:reset_running_tasks_on_startup:39 - 重置任务状态失败: the greenlet library is required to use this function. No module named 'greenlet'
2025-08-27 16:46:36 | ERROR    | app.services.task_monitor_service:initialize_task_monitoring:193 - 任务监控系统初始化失败: the greenlet library is required to use this function. No module named 'greenlet'
2025-08-27 16:46:36 | INFO     | app.startup:startup_event:14 - 应用启动完成
2025-08-27 16:46:45 | ERROR    | app.api.pipeline:get_pipeline_tree:886 - 获取管道分类树形结构失败: the greenlet library is required to use this function. No module named 'greenlet'
2025-08-27 16:47:00 | ERROR    | app.api.pipeline:get_pipeline_tree:886 - 获取管道分类树形结构失败: the greenlet library is required to use this function. No module named 'greenlet'
2025-08-27 16:47:08 | INFO     | app.startup:shutdown_event:24 - 应用关闭中...
2025-08-27 16:47:08 | INFO     | app.services.task_monitor_service:shutdown_task_monitoring:201 - 任务监控系统已关闭
2025-08-27 16:47:08 | INFO     | app.startup:shutdown_event:29 - 应用关闭完成
2025-08-27 16:47:11 | INFO     | app.utils.logger:setup_logger:38 - 日志系统初始化完成
2025-08-27 16:47:11 | INFO     | app.services.database_service:init_db:74 - 数据库已初始化，跳过
2025-08-27 16:47:11 | INFO     | app.startup:startup_event:9 - 应用启动中...
2025-08-27 16:47:11 | INFO     | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-08-27 16:47:15 | INFO     | app.services.task_monitor_service:reset_running_tasks_on_startup:36 - 未发现异常中断的任务
2025-08-27 16:47:15 | INFO     | app.services.task_monitor_service:start_monitoring:130 - 任务监控守护进程启动 - 检查间隔: 300秒, 超时时间: 60分钟
2025-08-27 16:47:15 | INFO     | app.services.task_monitor_service:initialize_task_monitoring:190 - 任务监控系统初始化完成
2025-08-27 16:47:15 | INFO     | app.startup:startup_event:14 - 应用启动完成
2025-08-27 16:47:20 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:48:52 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:49:54 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:50:16 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:50:18 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:50:26 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:51:56 | INFO     | app.startup:shutdown_event:24 - 应用关闭中...
2025-08-27 16:51:56 | INFO     | app.services.task_monitor_service:_monitor_loop:147 - 任务监控守护进程被取消
2025-08-27 16:51:56 | INFO     | app.services.task_monitor_service:stop_monitoring:166 - 任务监控守护进程已停止
2025-08-27 16:51:56 | INFO     | app.services.task_monitor_service:shutdown_task_monitoring:201 - 任务监控系统已关闭
2025-08-27 16:51:56 | INFO     | app.startup:shutdown_event:29 - 应用关闭完成
2025-08-27 16:51:56 | INFO     | app.services.database_service:close:106 - 数据库连接已关闭
2025-08-27 16:53:22 | INFO     | app.utils.logger:setup_logger:38 - 日志系统初始化完成
2025-08-27 16:53:22 | INFO     | app.services.database_service:init_db:74 - 数据库已初始化，跳过
2025-08-27 16:53:22 | INFO     | app.startup:startup_event:9 - 应用启动中...
2025-08-27 16:53:22 | INFO     | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-08-27 16:53:25 | INFO     | app.services.task_monitor_service:reset_running_tasks_on_startup:36 - 未发现异常中断的任务
2025-08-27 16:53:26 | INFO     | app.services.task_monitor_service:start_monitoring:130 - 任务监控守护进程启动 - 检查间隔: 300秒, 超时时间: 60分钟
2025-08-27 16:53:26 | INFO     | app.services.task_monitor_service:initialize_task_monitoring:190 - 任务监控系统初始化完成
2025-08-27 16:53:26 | INFO     | app.startup:startup_event:14 - 应用启动完成
2025-08-27 16:53:30 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:54:50 | INFO     | app.startup:shutdown_event:24 - 应用关闭中...
2025-08-27 16:54:50 | INFO     | app.services.task_monitor_service:_monitor_loop:147 - 任务监控守护进程被取消
2025-08-27 16:54:50 | INFO     | app.services.task_monitor_service:stop_monitoring:166 - 任务监控守护进程已停止
2025-08-27 16:54:50 | INFO     | app.services.task_monitor_service:shutdown_task_monitoring:201 - 任务监控系统已关闭
2025-08-27 16:54:50 | INFO     | app.startup:shutdown_event:29 - 应用关闭完成
2025-08-27 16:54:50 | INFO     | app.services.database_service:close:106 - 数据库连接已关闭
2025-08-27 16:54:55 | INFO     | app.utils.logger:setup_logger:38 - 日志系统初始化完成
2025-08-27 16:54:55 | INFO     | app.services.database_service:init_db:74 - 数据库已初始化，跳过
2025-08-27 16:54:55 | INFO     | app.startup:startup_event:9 - 应用启动中...
2025-08-27 16:54:55 | INFO     | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-08-27 16:54:59 | INFO     | app.services.task_monitor_service:reset_running_tasks_on_startup:36 - 未发现异常中断的任务
2025-08-27 16:55:00 | INFO     | app.services.task_monitor_service:start_monitoring:130 - 任务监控守护进程启动 - 检查间隔: 300秒, 超时时间: 60分钟
2025-08-27 16:55:00 | INFO     | app.services.task_monitor_service:initialize_task_monitoring:190 - 任务监控系统初始化完成
2025-08-27 16:55:00 | INFO     | app.startup:startup_event:14 - 应用启动完成
2025-08-27 16:55:51 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:55:53 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:55:54 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 16:57:43 | INFO     | app.utils.logger:setup_logger:38 - 日志系统初始化完成
2025-08-27 16:57:43 | INFO     | app.services.database_service:init_db:74 - 数据库已初始化，跳过
2025-08-27 16:57:43 | INFO     | app.startup:startup_event:9 - 应用启动中...
2025-08-27 16:57:43 | INFO     | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-08-27 16:57:47 | INFO     | app.services.task_monitor_service:reset_running_tasks_on_startup:36 - 未发现异常中断的任务
2025-08-27 16:57:47 | INFO     | app.services.task_monitor_service:start_monitoring:130 - 任务监控守护进程启动 - 检查间隔: 300秒, 超时时间: 60分钟
2025-08-27 16:57:47 | INFO     | app.services.task_monitor_service:initialize_task_monitoring:190 - 任务监控系统初始化完成
2025-08-27 16:57:47 | INFO     | app.startup:startup_event:14 - 应用启动完成
2025-08-27 17:03:20 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 17:03:21 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 17:03:23 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 17:31:42 | INFO     | app.startup:shutdown_event:24 - 应用关闭中...
2025-08-27 17:31:42 | INFO     | app.services.task_monitor_service:_monitor_loop:147 - 任务监控守护进程被取消
2025-08-27 17:31:42 | INFO     | app.services.task_monitor_service:stop_monitoring:166 - 任务监控守护进程已停止
2025-08-27 17:31:42 | INFO     | app.services.task_monitor_service:shutdown_task_monitoring:201 - 任务监控系统已关闭
2025-08-27 17:31:42 | INFO     | app.startup:shutdown_event:29 - 应用关闭完成
2025-08-27 17:31:42 | INFO     | app.services.database_service:close:106 - 数据库连接已关闭
2025-08-27 17:31:44 | INFO     | app.utils.logger:setup_logger:38 - 日志系统初始化完成
2025-08-27 17:31:44 | INFO     | app.services.database_service:init_db:74 - 数据库已初始化，跳过
2025-08-27 17:31:44 | INFO     | app.startup:startup_event:9 - 应用启动中...
2025-08-27 17:31:44 | INFO     | app.services.database_service:_create_engine:58 - 数据库引擎已创建: 35.215.85.104:13306/tp_chaindata_parser
2025-08-27 17:31:47 | WARNING  | app.services.task_monitor_service:reset_running_tasks_on_startup:26 - 发现 1 个异常中断的任务，将标记为失败
2025-08-27 17:31:47 | INFO     | app.services.task_monitor_service:reset_running_tasks_on_startup:31 - 任务 21 (pipeline_id: 3006) 标记为失败 - 程序重启导致
2025-08-27 17:31:48 | INFO     | app.services.task_monitor_service:reset_running_tasks_on_startup:34 - 已重置 1 个异常任务状态
2025-08-27 17:31:48 | INFO     | app.services.task_monitor_service:start_monitoring:130 - 任务监控守护进程启动 - 检查间隔: 300秒, 超时时间: 60分钟
2025-08-27 17:31:48 | INFO     | app.services.task_monitor_service:initialize_task_monitoring:190 - 任务监控系统初始化完成
2025-08-27 17:31:48 | INFO     | app.startup:startup_event:14 - 应用启动完成
2025-08-27 17:32:06 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=1
2025-08-27 17:32:08 | INFO     | app.api.writer_config:save_ingestion_config:67 - 更新数据摄取配置成功: component_id=1
2025-08-27 17:32:16 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=99999
2025-08-27 17:32:18 | INFO     | app.api.writer_config:save_ingestion_config:91 - 新增数据摄取配置成功: component_id=99999
2025-08-27 17:32:25 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=99999
2025-08-27 17:32:27 | INFO     | app.api.writer_config:save_ingestion_config:67 - 更新数据摄取配置成功: component_id=99999
2025-08-27 17:33:08 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=999
2025-08-27 17:33:10 | INFO     | app.api.writer_config:save_ingestion_config:91 - 新增数据摄取配置成功: component_id=999
2025-08-27 17:33:16 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=999
2025-08-27 17:33:18 | INFO     | app.api.writer_config:save_ingestion_config:67 - 更新数据摄取配置成功: component_id=999
2025-08-27 18:05:29 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:05:31 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:08:03 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:08:03 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:08:04 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:08:05 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:08:06 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:08:26 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=501
2025-08-27 18:08:29 | INFO     | app.api.writer_config:save_ingestion_config:91 - 新增数据摄取配置成功: component_id=501
2025-08-27 18:09:11 | INFO     | app.api.writer_config:save_ingestion_config:49 - 保存数据摄取配置: component_id=8453
2025-08-27 18:09:13 | INFO     | app.api.writer_config:save_ingestion_config:91 - 新增数据摄取配置成功: component_id=8453
2025-08-27 18:12:05 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:12:07 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:12:24 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:12:25 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:16:25 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:16:26 | INFO     | app.api.pipeline:get_pipeline_tree:877 - 获取管道分类树形结构成功: 分类数=8, 管道数=12, 根节点数=4
2025-08-27 18:16:29 | INFO     | app.services.pipeline_config_service:parse_and_save_pipeline:34 - 开始解析管道配置: usdc_transfer_monitor
2025-08-27 18:16:30 | INFO     | app.services.pipeline_config_service:_update_or_create_pipeline:82 - 更新现有管道: 6
2025-08-27 18:16:31 | INFO     | app.services.pipeline_config_service:_parse_and_save_components:135 - 创建组件成功: USDC转账事件监控器 (event_monitor)
2025-08-27 18:16:31 | INFO     | app.services.pipeline_config_service:_parse_and_save_components:135 - 创建组件成功: USDC简称查询 (contract_caller)
2025-08-27 18:16:32 | INFO     | app.services.pipeline_config_service:_parse_and_save_components:135 - 创建组件成功: USDC精度查询器 (contract_caller)
2025-08-27 18:16:32 | INFO     | app.services.pipeline_config_service:_parse_and_save_components:135 - 创建组件成功: 字段映射 (dict_mapper)
2025-08-27 18:16:33 | INFO     | app.services.pipeline_config_service:_parse_and_save_components:135 - 创建组件成功: USDC转账Kafka生产者 (kafka_producer)
2025-08-27 18:16:34 | INFO     | app.services.pipeline_config_service:parse_and_save_pipeline:45 - 管道配置保存成功: pipeline_id=6, components=5
2025-08-27 18:16:39 | INFO     | app.services.pipeline_config_service:start_pipeline_task:369 - 管道任务启动成功: pipeline_id=6, task_id=23
2025-08-27 18:16:39 | INFO     | app.services.pipeline_config_service:_execute_pipeline_async:402 - 开始执行管道任务: task_id=23
2025-08-27 18:16:39 | INFO     | app.component.pipeline_executor:_setup_logging:151 - 实例 74397a2f 日志配置完成 - 控制台输出 + 文件输出: /Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log
2025-08-27 18:16:39 | INFO     | app.component.pipeline_executor:__init__:56 - 从配置字典加载管道配置 - usdc_transfer_monitor
2025-08-27 18:16:39 | INFO     | app.component.pipeline_executor:__init__:62 - 区块链数据管道初始化完成 - usdc_transfer_monitor
2025-08-27 18:16:39 | INFO     | app.component.pipeline_executor:__init__:64 - 日志输出路径: logs/pipeline_6_20250827_181638.log
2025-08-27 18:16:39 | ERROR    | app.component.pipeline_executor:_load_abi_file:234 - ABI文件加载失败: ../abis/erc20.json, 错误: argument should be a str or an os.PathLike object where __fspath__ returns a str, not 'NoneType'
2025-08-27 18:16:42 | INFO     | app.services.evm_parser:get_web3:29 - 成功连接到 ethereum 网络
2025-08-27 18:16:42 | INFO     | app.component.contract_caller:__init__:41 - 合约方法调用器已初始化 - 链: ethereum, 合约: 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48
2025-08-27 18:16:42 | ERROR    | app.component.pipeline_executor:_load_abi_file:234 - ABI文件加载失败: ../abis/erc20.json, 错误: argument should be a str or an os.PathLike object where __fspath__ returns a str, not 'NoneType'
2025-08-27 18:16:42 | INFO     | app.component.contract_caller:__init__:41 - 合约方法调用器已初始化 - 链: ethereum, 合约: 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48
2025-08-27 18:16:42 | INFO     | app.component.dict_mapper:__init__:29 - 字典映射器初始化完成 - 规则数量: 0
2025-08-27 18:16:42 | INFO     | app.component.kafka_client:__init__:32 - Kafka客户端初始化 - 服务器: ['localhost:9092']
2025-08-27 18:16:44 | ERROR    | app.component.kafka_client:init_producer:79 - Kafka生产者初始化失败: NoBrokersAvailable
2025-08-27 18:16:44 | ERROR    | app.services.pipeline_config_service:_execute_pipeline_async:419 - 管道任务执行失败: task_id=23, 错误: NoBrokersAvailable
2025-08-27 18:16:51 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=13
2025-08-27 18:16:54 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=14
2025-08-27 18:16:57 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=15
2025-08-27 18:17:00 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=16
2025-08-27 18:17:03 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=17
2025-08-27 18:17:06 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=18
2025-08-27 18:17:09 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=19
2025-08-27 18:17:12 | INFO     | app.services.pipeline_config_service:get_task_log:558 - 读取任务日志成功: task_id=23, log_path=/Users/qmk/Documents/code/chain-data-parser/logs/pipeline_6_20250827_181638.log, returned_lines=20
