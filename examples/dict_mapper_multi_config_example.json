{
  "pipeline_name": "多映射器配置示例",
  "description": "演示如何配置多条 dict_mapper 记录",
  "classification_id": 1,
  "components": [
    {
      "name": "ERC20事件监控器",
      "type": "event_monitor",
      "chain_name": "ethereum",
      "contract_address": "0xA0b86a33E6441c8C06DD2c1c1e3e5C2b8b6C6E5D",
      "abi_path": "abis/erc20.json",
      "events_to_monitor": ["Transfer", "Approval"]
    },
    {
      "name": "多事件映射器",
      "type": "dict_mapper",
      "dict_mappers": [
        {
          "event_name": "Transfer",
          "mapping_rules": [
            {
              "source_key": "from",
              "target_key": "sender_address",
              "transformer": "to_lowercase",
              "condition": null,
              "default_value": null
            },
            {
              "source_key": "to",
              "target_key": "receiver_address", 
              "transformer": "to_lowercase",
              "condition": null,
              "default_value": null
            },
            {
              "source_key": "value",
              "target_key": "transfer_amount",
              "transformer": "wei_to_ether",
              "condition": null,
              "default_value": "0"
            },
            {
              "source_key": "blockNumber",
              "target_key": "block_number",
              "transformer": "to_int",
              "condition": null,
              "default_value": null
            }
          ]
        },
        {
          "event_name": "Approval",
          "mapping_rules": [
            {
              "source_key": "owner",
              "target_key": "token_owner",
              "transformer": "to_lowercase",
              "condition": null,
              "default_value": null
            },
            {
              "source_key": "spender",
              "target_key": "approved_spender",
              "transformer": "to_lowercase", 
              "condition": null,
              "default_value": null
            },
            {
              "source_key": "value",
              "target_key": "approved_amount",
              "transformer": "wei_to_ether",
              "condition": null,
              "default_value": "0"
            },
            {
              "source_key": "blockNumber",
              "target_key": "approval_block",
              "transformer": "to_int",
              "condition": null,
              "default_value": null
            }
          ]
        },
        {
          "event_name": null,
          "mapping_rules": [
            {
              "source_key": "transactionHash",
              "target_key": "tx_hash",
              "transformer": "to_lowercase",
              "condition": null,
              "default_value": null
            },
            {
              "source_key": "logIndex",
              "target_key": "log_index",
              "transformer": "to_int",
              "condition": null,
              "default_value": null
            },
            {
              "source_key": "timestamp",
              "target_key": "event_timestamp",
              "transformer": "unix_to_datetime",
              "condition": null,
              "default_value": null
            }
          ]
        }
      ]
    },
    {
      "name": "Kafka消息发送器",
      "type": "kafka_producer",
      "bootstrap_servers": "localhost:9092",
      "topic": "erc20_events"
    }
  ]
}
